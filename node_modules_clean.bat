@echo off
:: Set parent directorys
set "ParentDirectory=%~dp0"

echo Deleting all node_modules directories in "%ParentDirectory%"
:: Use FOR /D to loop through all subdirectories and match those named x64
for /d /r "%ParentDirectory%" %%D in (node_modules) do (
    echo Deleting "%%D"...
    rmdir /s /q "%%D"
)
echo Deleted all node_modules directories in "%ParentDirectory%"

:: taken from:
:: https://stackoverflow.com/questions/7831286/how-to-delete-empty-folders-using-windows-command-prompt
echo Searching and deleting empty directories in "%ParentDirectory%"
for /f "usebackq delims=" %%d in (`"dir /ad/b/s | sort /R"`) do rd "%%d"
echo Empty directory cleanup completed in "%ParentDirectory%"